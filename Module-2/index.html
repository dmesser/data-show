



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://ksingh7.github.io/data-show/Module-2/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.5.0">
    
    
      
        <title>Module-2 : Setting up OpenShift Container Platform - Ceph Data Show</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.2a88008a.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.792431c1.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://ksingh7.github.io/data-show/" title="Ceph Data Show" class="md-header-nav__button md-logo">
          
            <img src="../images/shadowman_rgb.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Ceph Data Show
              </span>
              <span class="md-header-nav__topic">
                Module-2 : Setting up OpenShift Container Platform
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../images/shadowman_rgb.png" width="24" height="24">
      
    </span>
    Ceph Data Show
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Module-1/" title="Module-1 : Ceph cluster & Object Storage Setup" class="md-nav__link">
      Module-1 : Ceph cluster & Object Storage Setup
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Module-2 : Setting up OpenShift Container Platform
      </label>
    
    <a href="./" title="Module-2 : Setting up OpenShift Container Platform" class="md-nav__link md-nav__link--active">
      Module-2 : Setting up OpenShift Container Platform
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create-an-openshift-project" title="Create an OpenShift Project" class="md-nav__link">
    Create an OpenShift Project
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#troubleshooting-the-jupyterhub-deployment" title="Troubleshooting the JupyterHub deployment" class="md-nav__link">
    Troubleshooting the JupyterHub deployment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Module-3/" title="Module-3 : Introduction to S3A & Loading Sample Data Set" class="md-nav__link">
      Module-3 : Introduction to S3A & Loading Sample Data Set
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Module-4/" title="Module-4 : Analytics on Metrics Data" class="md-nav__link">
      Module-4 : Analytics on Metrics Data
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Module-5/" title="Module-5 : ML using Jupyter Datahub on Ceph" class="md-nav__link">
      Module-5 : ML using Jupyter Datahub on Ceph
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create-an-openshift-project" title="Create an OpenShift Project" class="md-nav__link">
    Create an OpenShift Project
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#troubleshooting-the-jupyterhub-deployment" title="Troubleshooting the JupyterHub deployment" class="md-nav__link">
    Troubleshooting the JupyterHub deployment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="module-2-setting-up-jupyterhub-in-openshift-container-platform">Module - 2 : Setting up JupyterHub in OpenShift Container Platform<a class="headerlink" href="#module-2-setting-up-jupyterhub-in-openshift-container-platform" title="Permanent link">#</a></h1>
<div class="admonition summary">
<p class="admonition-title">Module Agenda</p>
<ul>
<li><strong>In this module you will be creating an OpenShift project for JupyterHub required for the rest of the sessions</strong></li>
</ul>
</div>
<ul>
<li>From your workstation login to the <code class="codehilite">OpenShift Master Node</code> with the user name <strong><code class="codehilite">cloud-user</code></strong> and <code class="codehilite">SSH Private Key</code> <a href="https://ksingh7.github.io/data-show/#accessing-the-lab">(Learn how to Login)</a></li>
</ul>
<div class="codehilite"><pre><span></span>chmod 400 &lt;path to ssh_key.pem&gt;
ssh -i &lt;path to ssh_key.pem&gt; cloud-user@&lt;OpenShift Master Node IP Address&gt;
</pre></div>

<div class="admonition example">
<p class="admonition-title">Prerequisite</p>
<ul>
<li>You must run all the commands logged in as user <strong>cloud-user</strong> on the <strong>OpenShift Master Node</strong> node, unless otherwise specified. </li>
</ul>
</div>
<h2 id="create-an-openshift-project">Create an OpenShift Project<a class="headerlink" href="#create-an-openshift-project" title="Permanent link">#</a></h2>
<p>In order to save your precious lab time, OpenShift Container Platform has already been installed and configured. Before you begin with some data science exercises, let&rsquo;s create an OpenShift project.</p>
<ul>
<li>Login to OpenShift Master Node as <code class="codehilite">cloud-user</code></li>
</ul>
<div class="codehilite"><pre><span></span>ssh -i &lt;path to ssh_key.pem&gt; cloud-user@&lt;OpenShift Master Node IP Address&gt;
</pre></div>

<ul>
<li>Login to OpenShift</li>
</ul>
<div class="codehilite"><pre><span></span>oc login -u teamuser1 -p openshift
</pre></div>

<ul>
<li>Create a new project</li>
</ul>
<div class="codehilite"><pre><span></span>oc new-project jupyterhub
</pre></div>

<ul>
<li>Prepare the OpenShift templates</li>
</ul>
<div class="codehilite"><pre><span></span>oc apply -f https://raw.githubusercontent.com/vpavlin/jupyterhub-ocp-oauth/ceph-summit-demo/notebooks.json
oc apply -f https://raw.githubusercontent.com/vpavlin/jupyterhub-ocp-oauth/ceph-summit-demo/templates.json
</pre></div>

<ul>
<li>Process the template to deploy the JupyterHub application</li>
</ul>
<div class="codehilite"><pre><span></span>oc process jupyterhub-ocp-oauth HASH_AUTHENTICATOR_SECRET_KEY=&quot;meh&quot; | oc apply -f -
</pre></div>

<ul>
<li>
<p>You should now have JupyterHub pods and services coming up ( will take some time to fully start).  The deployment is complete when the jupyterhub-db and jupyter pods are fully running.<br />
<div class="codehilite"><pre><span></span>oc get pods
</pre></div></p>
</li>
<li>
<p>You could also monitor your application from OpenShift Container Platform Console by visiting <code class="codehilite">OpenShift Console URL</code>. The user name and password to access the console is <code class="codehilite">teamuser1</code> and <code class="codehilite">openshift</code> respectively.</p>
</li>
<li>
<p>Verify you can access JupyterHub by visiting the URL.<br />
<div class="codehilite"><pre><span></span>oc get route jupyterhub -o jsonpath={.spec.host}
</pre></div></p>
</li>
<li>
<p>Verify you can log into JupyterHub by using the user name and password <code class="codehilite">user1</code> and <code class="codehilite">79e4e0</code> respectively.</p>
</li>
</ul>
<h3 id="troubleshooting-the-jupyterhub-deployment">Troubleshooting the JupyterHub deployment<a class="headerlink" href="#troubleshooting-the-jupyterhub-deployment" title="Permanent link">#</a></h3>
<p>Sometimes the JupyterHub deployment to OpenShift runs into race conditions.</p>
<ul>
<li>jupyterhub-db never comes up and constantly restarts.  This is often due to the PostgreSQL database not coming up cleanly.  If this occurs, the easiest thing to do is delete the JupyterHub project through the OpenShift Container Platform Console or via the command line.</li>
</ul>
<div class="codehilite"><pre><span></span>oc delete project jupyterhub
</pre></div>

<ul>
<li>You receive a <code class="codehilite">500 Internal Error</code>.  Do another deployment/rollout of JupyterHub which forces a restart of the server container and after connecting again to database.<br />
<div class="codehilite"><pre><span></span>oc rollout latest jupyterhub
</pre></div></li>
</ul>
<div class="admonition summary">
<p class="admonition-title">End of Module</p>
<p><strong>We have reached to the end of Module-2. At this point you have learned how to deploy an application on OCP. In the later modules we will use this application to perform some interesting data analytics work</strong></p>
</div>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Module-1/" title="Module-1 : Ceph cluster & Object Storage Setup" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Module-1 : Ceph cluster & Object Storage Setup
              </span>
            </div>
          </a>
        
        
          <a href="../Module-3/" title="Module-3 : Introduction to S3A & Loading Sample Data Set" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Module-3 : Introduction to S3A & Loading Sample Data Set
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright ©2018 Red Hat, Inc.
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://www.redhat.com/en/technologies/storage/ceph" class="md-footer-social__link fa fa-link"></a>
    
      <a href="https://twitter.com/RedHatStorage" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://github.com/ceph/ceph" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://www.linkedin.com/company/3545/" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.ce2ab4bf.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>